# YYC³ AI Assistant - 项目同步文档

## 📅 版本记录
**阶段:** V2.1 (Persistence & AI Control)  
**日期:** 2026-01-28  
**状态:** 已完成

---

## 🚀 本阶段更新摘要

### 1. 记忆持久化 (State Persistence)
*   **功能**: 现在刷新浏览器页面后，用户的对话记录（History）和 API 设置（Config）不再丢失。
*   **实现**: 
    *   在 `useEffect` 初始化时读取 `localStorage`。
    *   监听 `messages` 变化并自动写入存储。
    *   在保存配置时同步写入存储。
*   **Key**: `yyc_history`, `yyc_config`

### 2. AI 智能控屏 (Function Calling / AI Control)
*   **功能**: AI 现在可以根据用户的自然语言指令控制界面，无需用户手动点击。
*   **协议**: 采用 `Prompt Engineering` + `Regex Parsing` 方式实现轻量级指令系统。
    *   AI 输出格式: `回复内容 [[CMD:指令名]]`
    *   前端解析并执行指令，同时从显示文本中隐藏指令代码。
*   **支持指令**:
    *   `OPEN_SETTINGS`: 打开设置面板 (例如: "帮我打开设置")
    *   `OPEN_HISTORY`: 打开历史记录 (例如: "我想看刚才说了什么")
    *   `THEME_RED` / `THEME_CYAN`: 切换红色警戒/青色默认主题 (例如: "切换到红色警戒模式")

### 3. 主题引擎 (Dynamic Themes)
*   **功能**: 支持动态切换应用的主题色调（背景光流、字体颜色、HUD 颜色）。
*   **实现**: 通过 `themeColor` 状态控制 Tailwind CSS 类名的条件渲染。

---

## 🛠️ 测试用例 (验证指南)

1.  **测试记忆**: 
    *   输入几句对话。
    *   刷新浏览器。
    *   上滑打开历史记录，确认之前的对话还在。

2.  **测试 AI 控制**:
    *   对 AI 说: **"把主题换成红色的"**。
    *   预期: AI 回复确认，并且界面背景变为深红色，光效变为橙红色。
    *   对 AI 说: **"打开设置面板"**。
    *   预期: 设置面板自动从右侧滑出。

3.  **测试配置保存**:
    *   左滑打开设置，将模型名改为 `gpt-4-turbo`。
    *   保存并刷新页面。
    *   再次打开设置，确认模型名仍为 `gpt-4-turbo`。

---

## ⚠️ 注意事项
*   **安全**: API Key 目前明文存储在浏览器的 `localStorage` 中。在生产环境中，这属于不安全行为，仅适用于原型演示。
*   **指令准确率**: 如果 AI 没有准确执行指令，尝试在“设置”中重置 Prompt，确保系统提示词中包含关于 `[[CMD:...]]` 的说明。
